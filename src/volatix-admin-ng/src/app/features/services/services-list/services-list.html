<div class="grid">
  <section>
    <div class="card">
      <h2 class="text-app" style="margin-bottom: 1rem">Registered services</h2>

      @if (isLoading()) {
        <div style="text-align: center; padding: 48px; color: var(--muted);">
          <div style="display: inline-block; width: 40px; height: 40px; border: 3px solid var(--glass-border); border-top-color: var(--accent); border-radius: 50%; animation: spin 0.8s linear infinite;"></div>
          <div style="margin-top: 16px; font-size: 14px;">Loading services...</div>
        </div>
      } @else {
        <table class="min-w-full table-fixed text-sm">
          <thead>
            <tr class="text-left text-xs text-slate-400 border-b border-slate-800">
              <th class="p-2 w-64">Service</th>
              <th class="p-2 w-24">Status</th>
              <th class="p-2 w-24">Instances</th>
              <th class="p-2 w-24">Version</th>
              <th class="p-2 w-48">Last seen</th>
              <th class="p-2 col-actions">Actions</th>
            </tr>
          </thead>
          <tbody>
          @for (service of paginatedServices; track service.id || service.name) {
          <tr>
            <td class="p-2">{{ service.name }}</td>
            <td class="p-2" style="text-transform: capitalize">
              {{ service.status || 'â€”' }}
              @switch ((service.status || 'unknown').toLowerCase()) { @case ('healthy') {
              <span style="color: #10b981; font-size: 12px; margin-left: 6px">âœ“</span>
              } @case ('degraded') {
              <span style="color: #f59e0b; font-size: 12px; margin-left: 6px">âš </span>
              } @case ('down') {
              <span style="color: #ef4444; font-size: 12px; margin-left: 6px">âœ—</span>
              } @case ('maintenance') {
              <span style="color: #6b7280; font-size: 12px; margin-left: 6px">ðŸ”§</span>
              } @default {
              <span style="color: #6b7280; font-size: 12px; margin-left: 6px">?</span>
              } }
            </td>
            <td class="p-2">{{ service.instances || 'â€”' }}</td>
            <td class="p-2">{{ service.version || 'â€”' }}</td>
            <td class="p-2">{{ service.lastSeen || 'Unknown' }}</td>
            <td class="p-2 col-actions">
              <div class="table-actions">
                <button class="btn primary sm btn-ripple" (click)="viewServiceDetails(service)">
                  <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                    />
                  </svg>
                  Details
                </button>
                <button class="btn secondary sm btn-ripple" (click)="pingService(service)">
                  <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"
                    />
                  </svg>
                  Ping
                </button>
              </div>
            </td>
          </tr>
          } @empty {
          <tr>
            <td class="p-2 text-slate-400" colspan="5">No services found.</td>
          </tr>
          }
        </tbody>
      </table>

      <app-pagination
        [currentPage]="currentPage()"
        [totalPages]="totalPages"
        [pageInfo]="'Page ' + currentPage() + ' of ' + totalPages"
        (pageChange)="onPageChange($event)"
        (prevClick)="onPageChange(currentPage() - 1)"
        (nextClick)="onPageChange(currentPage() + 1)"
      >
      </app-pagination>
      }
    </div>
  </section>

  <aside>
    <div class="card">
      <h2>Notes</h2>
      <div style="font-size: 12px">
        Services register caches and policies at startup. Keep clients up to date.
      </div>
    </div>
  </aside>
</div>
